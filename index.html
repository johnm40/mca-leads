<!DOCTYPE html>
<html>
<head>
<title>MCA Lead Finder 2.0</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #0c1320;
        color: white;
        text-align: center;
        padding: 20px;
    }
    h1 { font-size: 42px; color: #f6d76d; }
    input, select {
        padding: 12px;
        border-radius: 6px;
        width: 280px;
        margin: 5px;
        border: none;
        font-size: 16px;
    }
    button {
        padding: 12px 22px;
        border: none;
        border-radius: 6px;
        background: #f6d76d;
        font-weight: bold;
        cursor: pointer;
        font-size: 18px;
    }
    .card {
        margin: 15px auto;
        padding: 18px;
        width: 80%;
        background: #111a2b;
        border-left: 6px solid #f6d76d;
        border-radius: 6px;
        text-align: left;
    }
</style>
</head>
<body>

<h1>Free MCA Lead Finder 2.0</h1>

<!-- SEARCH BAR -->
<input id="keyword" placeholder="Industry (contractor, dentist, etc)">
<select id="state">
    <option value="">All States</option>
</select>

<input id="minRev" placeholder="Min Revenue ($)">
<input id="maxRev" placeholder="Max Revenue ($)">
<input type="date" id="filedAfter">

<select id="sortOrder">
    <option value="desc">Revenue: High â†’ Low</option>
    <option value="asc">Revenue: Low â†’ High</option>
</select>

<button onclick="findLeads()">Search</button>

<div id="results"></div>

<script>
// populate state list
const states = ["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"];
document.getElementById("state").innerHTML += states.map(s => `<option value="${s}">${s}</option>`).join("");

async function findLeads() {
    let keyword = document.getElementById("keyword").value;
    let state = document.getElementById("state").value;
    let minRev = document.getElementById("minRev").value || 0;
    let maxRev = document.getElementById("maxRev").value || 999999999;
    let filedAfter = document.getElementById("filedAfter").value || "1900-01-01";
    let sortOrder = document.getElementById("sortOrder").value;

    document.getElementById("results").innerHTML = "Searchingâ€¦";

    let res = await fetch(`/api/leads?keyword=${keyword}&state=${state}&minRev=${minRev}&maxRev=${maxRev}&filedAfter=${filedAfter}&sortOrder=${sortOrder}`);
    let data = await res.json();

    if (!data.length) {
        document.getElementById("results").innerHTML = "No leads found.";
        return;
    }

    document.getElementById("results").innerHTML = data.map(b => `
        <div class="card">
            <b>${b.name}</b><br>
            ğŸ“ ${b.address}<br>
            ğŸ“ ${b.phone || "N/A"}<br>
            ğŸŒ <a href="${b.website}" target="_blank">${b.website || "N/A"}</a><br>
            âœ‰ï¸ ${b.email || "N/A"}<br>
            ğŸ‘¤ Owner: ${b.owner || "N/A"}<br>
            ğŸ—“ Filed: ${b.filedDate || "N/A"}<br>
            ğŸ’° Est. Revenue: $${b.revenue || "N/A"}<br>
        </div>
    `).join("");
}
</script>

</body>
</html>
